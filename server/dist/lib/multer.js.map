{"version":3,"sources":["../../src/lib/multer.ts"],"sourcesContent":["import multer from \"multer\";\r\nimport path from \"path\";\r\n\r\n\r\nconst storage = multer.diskStorage({\r\n  destination: (req, file, cb) => {\r\n    cb(null, \"uploads/\"); \r\n  },\r\n  filename: (req, file, cb) => {\r\n    const uniqueSuffix = Date.now() + \"-\" + Math.round(Math.random() * 1e9);\r\n    cb(null, file.fieldname + \"-\" + uniqueSuffix + path.extname(file.originalname));\r\n  },\r\n});\r\n\r\n\r\nconst fileFilter = (req: Express.Request, file: Express.Multer.File, cb: multer.FileFilterCallback) => {\r\n  if (file.mimetype.startsWith(\"image/\")) {\r\n    cb(null, true);\r\n  } else {\r\n    cb(new Error(\"Only image files are allowed\"));\r\n  }\r\n};\r\n\r\n\r\nconst upload = multer({ storage, fileFilter });\r\n\r\nexport default upload;\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAmB;AACnB,kBAAiB;AAGjB,IAAM,UAAU,cAAAA,QAAO,YAAY;AAAA,EACjC,aAAa,CAAC,KAAK,MAAM,OAAO;AAC9B,OAAG,MAAM,UAAU;AAAA,EACrB;AAAA,EACA,UAAU,CAAC,KAAK,MAAM,OAAO;AAC3B,UAAM,eAAe,KAAK,IAAI,IAAI,MAAM,KAAK,MAAM,KAAK,OAAO,IAAI,GAAG;AACtE,OAAG,MAAM,KAAK,YAAY,MAAM,eAAe,YAAAC,QAAK,QAAQ,KAAK,YAAY,CAAC;AAAA,EAChF;AACF,CAAC;AAGD,IAAM,aAAa,CAAC,KAAsB,MAA2B,OAAkC;AACrG,MAAI,KAAK,SAAS,WAAW,QAAQ,GAAG;AACtC,OAAG,MAAM,IAAI;AAAA,EACf,OAAO;AACL,OAAG,IAAI,MAAM,8BAA8B,CAAC;AAAA,EAC9C;AACF;AAGA,IAAM,aAAS,cAAAD,SAAO,EAAE,SAAS,WAAW,CAAC;AAE7C,IAAO,iBAAQ;","names":["multer","path"]}